import{a as D,b as N}from"./chunk-UPTB5CUN.js";import{b as y}from"./chunk-LE7PDSF6.js";import{b as S,c as m,d as _,e as x,g as T,h as E,i as F,j as k,k as A,l as P}from"./chunk-CSCWTK3S.js";import{a as M}from"./chunk-G2MVUGH5.js";import{f as w}from"./chunk-KQ377FIY.js";import{a as b,b as C}from"./chunk-ZZTYWBEX.js";import{Ba as i,Eb as d,La as g,Mb as u,V as c,a as h,ab as r,kb as t,lb as s,lc as v,mb as n,rb as f}from"./chunk-L5COCKNF.js";var U=l=>({"is__invalid-input":l}),V=l=>({"peer-focus:text-destructive!":l}),W=(()=>{class l{constructor(){this._loginAccessService=c(y),this._formBuilder=c(k),this._router=c(w),this.userData={},this.submitted=!1,this.confirmPasswordTextType=!1,this.alertType=""}showAlert(o){this.alertType="",setTimeout(()=>{this.alertType=o},0)}onClick(){console.log("Button clicked")}ngOnInit(){this.userData=this._loginAccessService.getCurrentSession("currentUser"),this.form=this._formBuilder.group({password:["",[m.required,m.maxLength(50),m.minLength(3)]],password2:["",[m.required,m.maxLength(50),m.minLength(3)]]},{validators:this.passwordMatchValidator.bind(this)})}get f(){return this.form.controls}toggleVisibility(o){this[o]=!this[o]}passwordMatchValidator(o){let p=o.get("password")?.value,e=o.get("password2");if(!e)return;let a=h({},e.errors);p!==e.value?(a.passwordMismatch=!0,e.setErrors(a)):("passwordMismatch"in a&&delete a.passwordMismatch,e.setErrors(Object.keys(a).length?a:null))}onSubmit(){if(this.submitted=!0,this.form.invalid)return;let o=this.userData.otherParams.username,{password2:p}=this.form.value;this._loginAccessService.UpdatePassword(o,p).subscribe({next:()=>{this.showAlert("success"),setTimeout(()=>{this._loginAccessService.deleteCurrentSession("currentUser"),this._router.navigate(["/auth/sign-in"])},2e3)},error:e=>{console.log("Error recibido:",e),e.error&&console.error("Detalles del error:",e.error),this.showAlert("error")}})}static{this.\u0275fac=function(p){return new(p||l)}}static{this.\u0275cmp=g({type:l,selectors:[["app-update-password"]],decls:38,vars:25,consts:[[1,"my-10","mx-auto","w-full","space-y-6","md:w-1/2",3,"ngSubmit","formGroup"],[1,"text-center"],[1,"text-foreground","mb-1","text-3xl","font-semibold"],[1,"text-primary"],[1,"space-y-3","text-left"],[1,"relative"],["type","text","id","user","placeholder","","disabled","",1,"peer","block",3,"value"],["for","user",1,"bg-background","text-muted-foreground","peer-focus:text-primary","absolute","top-2","z-10","origin-[0]","-translate-y-4","scale-95","transform","px-2","text-sm","duration-300","peer-placeholder-shown:top-1/2","peer-placeholder-shown:-translate-y-1/2","peer-placeholder-shown:scale-100","peer-focus:top-2","peer-focus:-translate-y-4","peer-focus:scale-95","peer-focus:px-2","ltr:left-1","rtl:right-1"],[1,"form__group"],["id","password","placeholder"," ","formControlName","password",1,"peer","block",3,"type","ngClass"],["for","password",1,"bg-background","text-muted-foreground","peer-focus:text-primary","absolute","top-2","z-10","origin-[0]","-translate-y-4","scale-95","transform","px-2","text-sm","duration-300","peer-placeholder-shown:top-1/2","peer-placeholder-shown:-translate-y-1/2","peer-placeholder-shown:scale-100","peer-focus:top-2","peer-focus:-translate-y-4","peer-focus:scale-95","peer-focus:px-2","ltr:left-1","rtl:right-1",3,"ngClass"],[1,"text-muted-foreground","absolute","top-2","cursor-pointer","ltr:right-3","rtl:left-3",3,"click"],[3,"src","svgClass"],[3,"control","submitted"],["id","password2","placeholder"," ","formControlName","password2",1,"peer","block",3,"type","ngClass"],["for","password2",1,"bg-background","text-muted-foreground","peer-focus:text-primary","absolute","top-2","z-10","origin-[0]","-translate-y-4","scale-95","transform","px-2","text-sm","duration-300","peer-placeholder-shown:top-1/2","peer-placeholder-shown:-translate-y-1/2","peer-placeholder-shown:scale-100","peer-focus:top-2","peer-focus:-translate-y-4","peer-focus:scale-95","peer-focus:px-2","ltr:left-1","rtl:right-1",3,"ngClass"],[1,"grid","grid-cols-4","gap-2"],[1,"rounded-xs","bg-muted","h-1"],[1,"text-muted-foreground","text-xs"],["full","","impact","bold","tone","primary","shape","rounded","size","medium"],[3,"type"]],template:function(p,e){p&1&&(t(0,"form",0),f("ngSubmit",function(){return e.onSubmit()}),t(1,"div",1)(2,"h2",2),d(3,"Nueva Contrase\xF1a "),t(4,"span",3),d(5,"!"),s()()(),t(6,"div",4)(7,"div",5),n(8,"input",6),t(9,"label",7),d(10," Usuario "),s()(),t(11,"div",8)(12,"div",5),n(13,"input",9),t(14,"label",10),d(15," Contrase\xF1a "),s(),t(16,"span",11),f("click",function(){return e.toggleVisibility("passwordTextType")}),n(17,"svg-icon",12),s()(),n(18,"app-validation",13),s(),t(19,"div",8)(20,"div",5),n(21,"input",14),t(22,"label",15),d(23," Confirmar Contrase\xF1a "),s(),t(24,"span",11),f("click",function(){return e.toggleVisibility("confirmPasswordTextType")}),n(25,"svg-icon",12),s()(),n(26,"app-validation",13),s(),t(27,"div",16),n(28,"div",17)(29,"div",17)(30,"div",17)(31,"div",17),s(),t(32,"span",18),d(33," Recomendacion: usar 8 o m\xE1s caracteres con una combinaci\xF3n de letras, n\xFAmeros y s\xEDmbolos. "),s()(),t(34,"div")(35,"app-button",19),d(36,"Actualizar"),s()()(),n(37,"app-alerts",20)),p&2&&(r("formGroup",e.form),i(8),r("value",e.userData.otherParams.username),i(5),r("type",e.passwordTextType?"text":"password")("ngClass",u(17,U,e.submitted&&e.f.password.errors)),i(),r("ngClass",u(19,V,e.submitted&&e.f.password.errors)),i(3),r("src",e.passwordTextType?"assets/icons/heroicons/outline/eye.svg":"assets/icons/heroicons/outline/eye-off.svg")("svgClass","h-5 w-5"),i(),r("control",e.f.password)("submitted",e.submitted),i(3),r("type",e.confirmPasswordTextType?"text":"password")("ngClass",u(21,U,e.submitted&&e.f.password2.errors)),i(),r("ngClass",u(23,V,e.submitted&&e.f.password2.errors)),i(3),r("src",e.confirmPasswordTextType?"assets/icons/heroicons/outline/eye.svg":"assets/icons/heroicons/outline/eye-off.svg")("svgClass","h-5 w-5"),i(),r("control",e.f.password2)("submitted",e.submitted),i(11),r("type",e.alertType))},dependencies:[A,T,S,_,x,C,b,M,P,E,F,v,D,N],encapsulation:2})}}return l})();export{W as UpdatePasswordComponent};
